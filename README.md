# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Описание модулей

### src/components/catalog.ts
Компонент каталога, отвечает за загрузку и отображение списка товаров.

### src/components/card.ts
Компонент карточки товара, отображает информацию о товаре и обрабатывает открытие модального окна с подробной информацией.

### src/components/cardPreview.ts
Компонент модального окна с подробной информацией о товаре, позволяет добавить товар в корзину.

### src/components/modal.ts
Базовый компонент модального окна, обеспечивает открытие и закрытие модальных окон.

### src/components/order.ts
Компонент оформления заказа, реализует многошаговую форму с выбором способа оплаты и вводом контактных данных.

### src/components/basket.ts
Компонент корзины, отображает список добавленных товаров и позволяет управлять ими.

### src/utils/constants.ts
Файл с константами, используемыми в проекте.

### src/utils/utils.ts
Вспомогательные функции общего назначения.

## Тестирование
- В заданном элементе html должен отображаться каталог товаров
- При нажатии на карточку должно открываться модальное окно с подробной информацией о карте
- Товары должны добавляться в корзину при нажатии кнопки "В корзину"
- Карточки и подробная информация должны отображать актуальные данные
- У форм оформления заказа должна быть валидация

## Паттерн проектирования

В проекте используется паттерн **MVC (Model-View-Controller)**.

### Группировка классов по слоям паттерна

#### Представление 
- **Catalog** (src/components/catalog.ts)  
  Загружает и отображает список товаров.
- **Card** (src/components/card.ts)  
  Отображает карточку товара и обрабатывает открытие модального окна.
- **CardPreview** (src/components/cardPreview.ts)  
  Модальное окно с подробной информацией о товаре и добавлением в корзину.
- **Modal** (src/components/modal.ts)  
  Базовый компонент модальных окон.
- **Order** (src/components/order.ts)  
  Многошаговая форма оформления заказа.
- **Basket** (src/components/basket.ts)  
  Отображает содержимое корзины и управляет элементами.

### Описание классов

- **Catalog**  
  - Задача: загрузка и отображение списка товаров каталога.  
  - Поля:  
    - `container`: HTMLElement для рендера товаров  
    - `api`: объект для выполнения запросов  
  - Методы:  
    - `loadProducts(url?: string)`: загружает товары с сервера  
    - `renderProducts(products: IProduct[])`: отображает товары в контейнере

- **Card**  
  - Задача: отображение карточки товара и обработка клика для открытия подробной информации.  
  - Поля:  
    - `product`: объект товара  
    - `element`: HTMLElement карточки  
    - `cardPreview`: экземпляр CardPreview для модального окна  
  - Методы:  
    - `createCardElement()`: создает DOM-элемент карточки  
    - `openModal()`: открывает модальное окно с подробностями  
    - `getElement()`: возвращает DOM-элемент карточки

- **CardPreview**  
  - Задача: модальное окно с подробной информацией о товаре и добавлением в корзину.  
  - Поля:  
    - `data`: объект с данными товара  
    - `addToBasketHandler`: функция-обработчик клика по кнопке добавления  
  - Методы:  
    - `open()`: открывает модальное окно с данными  
    - `close()`: закрывает модальное окно
    - `addToBasket()`: добавляет товар в корзину  
    - `initEventListeners()`: инициализирует обработчики событий  
    - `applyCategoryColor()`: применяет цвет категории к элементу

- **Modal**  
  - Задача: базовый функционал модальных окон, управление открытием и закрытием.  
  - Методы:  
    - `openModal(options: IModalOptions)`: открывает модальное окно по шаблону  
    - `closeModal()`: закрывает активное модальное окно

- **Order**  
  - Задача: оформление заказа с многошаговой формой, валидация и сбор данных.  
  - Поля:  
    - `currentStep`: номер текущего шага  
    - `modalElement`: HTMLElement модального окна  
    - `paymentButtonsContainer`: контейнер кнопок оплаты  
    - `paymentButtons`: список кнопок оплаты  
    - `addressInput`: поле ввода адреса  
    - `nextButton`: кнопка перехода к следующему шагу  
    - `form`: HTML-форма  
    - `orderData`: объект с данными заказа  
  - Методы:  
    - `start()`: запуск процесса оформления  
    - `openStep(step: number)`: открытие конкретного шага  
    - `openPaymentStep()`: открытие шага оплаты  
    - `initPaymentForm(modal: HTMLElement)`: инициализация формы оплаты  
    - `setButtonAttributes(button: HTMLButtonElement, selected: boolean)`: установка состояния кнопок  
    - `onPaymentButtonClick(event: Event)`: обработка клика по кнопкам оплаты  
    - `validatePaymentForm()`: валидация формы оплаты  
    - `openContactsStep()`: открытие шага контактов  
    - `initContactsForm(modal: HTMLElement)`: инициализация формы контактов  
    - `openSuccessStep()`: открытие шага успешного оформления  
    - `calculateTotalPrice()`: расчет итоговой суммы  
    - `close()`: закрытие модального окна

- **Basket**  
  - Задача: отображение и управление корзиной.

### Взаимодействие между слоями модели и представления

- Модель реализует паттерн наблюдателя (Observer) с методом subscribe(listener), вызываемым при изменении состояния.
- Представление подписывается на изменения модели и обновляет UI.
- Пользовательские события: добавление товара в корзину, удаление товара, оформление заказа.
- События вызывают методы модели, которая уведомляет представление.
- Для расширения взаимодействия можно использовать EventEmitter для объявления и обработки событий.